# 氣喘控制測驗 C-ACT / ACT 互動問卷

單頁 HTML 工具，**兒童（C-ACT）與成人（ACT）** 皆可使用，品牌：**黑眼圈奶爸 Dr. 徐嘉賢醫師**。

---

## 一、如何「使用」這個 App（病患端）

1. **開啟網頁**  
   用瀏覽器打開 `index.html`（本機雙擊即可），或您部署後的網址。

2. **選擇測驗類型**  
   - **兒童 C-ACT**：4～11 歲，由小朋友答前 4 題（點選表情）、家長答後 3 題。  
   - **成人 ACT**：12 歲以上，自己答 5 題。

3. **看高雄天氣建議**  
   頁面會自動顯示今日高雄溫度、濕度與簡短照護建議。

4. **依序作答**  
   每題選一個選項，全部答完後按 **「看結果」**。

5. **看結果**  
   會顯示總分與紅黃綠燈分級（控制良好／部分控制／控制不佳）及簡短說明。

6. **取得報告（必填姓名與 Email）**  
   填寫 **姓名**、**Email**，並勾選 **同意條款**（同意診所寄送報告至 Email，以及日後以該 Email 寄送衛教／活動資訊），按 **「送出並寄送報告至 Email」**：  
   - 報告會自動寄到您填寫的 Email（HTML 格式，含分數、等級、建議與預約連結）。  
   - 結果會一併寫入診所 Google 試算表（若已設定）。

7. **預約就診**  
   可點頂部 **「線上掛號」** 按鈕，連到 [徐嘉賢診所線上掛號](https://08143.vision.com.tw/Register)。

---

## 二、如何「設定」這個 App（診所端）

### 最簡單：本機使用（不用設定）

- 直接雙擊 **`index.html`** 用瀏覽器開啟即可使用。  
- 測驗、結果、列印成 PDF 都能用；只是不會把資料寫入 Google 試算表。

### 在診所 iPad 上使用

1. **先讓 App 有網址**（二擇一）  
   - **建議**：把整個 **`c-act-asthma-tool`** 資料夾上傳到 [Netlify Drop](https://app.netlify.com/drop)（拖曳資料夾即可），取得一個網址，例如 `https://xxxx.netlify.app`。  
   - 或上傳到 **GitHub Pages** 後取得網址。

2. **在 iPad 上開啟**  
   - 用 **Safari** 開啟上述網址（不要用 Chrome 等，以便使用「加入主畫面」）。

3. **（選用）加入主畫面，像 App 一樣**  
   - 在 Safari 點下方 **分享** 按鈕 → **加入主畫面** → 名稱可設為「氣喘測驗」→ **加入**。  
   - 之後從 iPad 主畫面點這個圖示即可開啟，不需再輸入網址。

4. **注意**  
   - iPad 需連上網路（Wi‑Fi 或 4G），測驗結果才會正常儲存到 Google 試算表並寄送 Email。  
   - 若尚未設定 `GOOGLE_SCRIPT_URL`，測驗與結果仍可正常使用，只是不會寫入試算表、也不會寄信。

### 對外開放：部署到網路

1. 將整個 **`c-act-asthma-tool`** 資料夾上傳到：
   - **Netlify**：拖曳資料夾到 [netlify.com/drop](https://app.netlify.com/drop)，或連到 Git 倉庫部署。  
   - **GitHub Pages**：把資料夾推上 GitHub，在倉庫設定裡開啟 Pages、選擇分支與資料夾。  
2. 部署完成後會得到一個網址（例如 `https://xxx.netlify.app`），把這網址分享給病患即可。

### 選用：把測驗結果存到 Google 試算表

若希望每次有人填寫 Email 並送出時，自動在 Google 試算表新增一列（時間、Email、分數、等級、天氣等），請依下列步驟設定一次即可。

## 功能

- **兒童 C-ACT（4～11 歲）**：7 題，前 4 題表情選項、後 3 題家長填寫，總分 0～27。
- **成人 ACT（12 歲以上）**：5 題自填，總分 5～25。
- **紅黃綠燈結果**：
  - 兒童：🟢 ≥20 控制良好／🟡 13～19 部分控制／🔴 ≤12 控制不佳
  - 成人：🟢 ≥20 控制良好／🟡 16～19 未完全控制／🔴 ≤15 控制不佳
- **高雄天氣與建議**：自動顯示高雄當日溫度、濕度，並依濕度/氣溫給病患簡短建議（如除濕、保暖、戶外注意等）。
- **Email 與 PDF**：輸入 Email 後可「送出並下載 PDF」；送出時會一併將結果寫入您的 **Google 試算表**。

## 使用方式

1. 用瀏覽器開啟 `index.html` 即可使用（無需伺服器）。
2. 部署：將整個資料夾上傳到 **Netlify** 或 **GitHub Pages** 即可對外提供連結。

## 將 ACT 分數送到 Google 試算表

1. **新增 Google 試算表**  
   到 [Google 試算表](https://sheets.google.com) 建立一個新的試算表（可命名為「氣喘測驗結果」）。

2. **開啟 Apps Script**  
   在試算表選單：**擴充功能** → **Apps Script**。

3. **貼上程式碼**  
   開啟專案裡的 `GoogleAppsScript-Code.gs`，將**全部內容**複製貼到 Apps Script 編輯器（預設的 `function myFunction() {}` 可刪掉），儲存。

4. **部署為網路應用程式**  
   - 點上方 **部署** → **新增部署**  
   - 類型選 **網路應用程式**  
   - **說明**可填：ACT 表單接收  
   - **執行身分**：我  
   - **存取權**：**任何人**（這樣網頁才能從外部送出資料）  
   - 按 **部署**，完成後會出現 **網路應用程式 URL**（長得像 `https://script.google.com/macros/s/xxxxx/exec`）。

5. **把網址填進網頁**  
   用編輯器開啟 `index.html`，搜尋 `GOOGLE_SCRIPT_URL`，把空字串改成您的網路應用程式 URL，例如：

   ```javascript
   var GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/您的ID/exec';
   ```

   **寄信說明**：報告信件會由「您登入 Apps Script 的 Google 帳號」的 Gmail 寄出。第一次執行時若出現權限提示，請同意「傳送電子郵件」等權限。若病患收不到信，可請其檢查垃圾郵件。

之後只要病患填寫**姓名**、**Email**、勾選同意條款並按「送出並寄送報告至 Email」，就會：  
- 有一筆新列寫入試算表，欄位包含：時間、姓名、Email、同意寄送報告及行銷、測驗類型、分數、控制等級、高雄氣溫、濕度、天氣建議等；  
- 同時由您的 Gmail（Apps Script 執行帳號）寄送一封 **HTML 報告信**到病患 Email，內容含測驗結果與預約連結。

**與其他 Google 帳號共用試算表：**  
同一般 Google 試算表，建立者可以點試算表右上角 **「共用」**，輸入對方的 Gmail，選擇 **檢視者**、**加註者** 或 **編輯者** 權限後送出，對方用該 Google 帳號登入即可看到同一份結果。

## 報告寄送方式

- 病患須填寫**姓名**、**Email**，並勾選**同意條款**（同意接收報告並同意診所日後以該 Email 寄送衛教／活動資訊）。
- 點「**送出並寄送報告至 Email**」後，**不會**開啟列印視窗；報告會以 **HTML 信件**寄到病患的 Email。
- 信件內容包含：診所名稱、測驗類型、總分、控制等級、說明、今日天氣建議、線上掛號連結。

## 自訂

- **預約連結**：在 `index.html` 搜尋「預約諮詢與門診資訊」，改為您的實際網址或 LINE 連結即可。
- **未設定 Google 網址**：若 `GOOGLE_SCRIPT_URL` 留空，網頁仍可正常測驗與下載 PDF，只是不會寫入試算表。
